"use strict";(self.webpackChunkfirst_app=self.webpackChunkfirst_app||[]).push([[258],{7258:(tt,C,o)=>{o.r(C),o.d(C,{BuyingModule:()=>R});var d=o(6895),t=o(6738),_=o(1215),x=o(914),p=o(2517),Z=o(4471),h=o(6406),l=o(4719);function A(i,c){1&i&&(t.TgZ(0,"h3",3),t._uU(1,"Your Cart is empty"),t.qZA())}function O(i,c){if(1&i&&(t.TgZ(0,"li",28)(1,"span"),t._uU(2),t.qZA(),t.TgZ(3,"div",29)(4,"span",30),t._uU(5),t.qZA(),t.TgZ(6,"span"),t._uU(7),t.qZA()()()),2&i){const e=c.$implicit;t.xp6(2),t.Oqu(e.product.name),t.xp6(3),t.Oqu("$"+e.product.price),t.xp6(2),t.Oqu("Quantity :"+e.quantity)}}function M(i,c){1&i&&(t.TgZ(0,"small"),t._uU(1,"Address is a required field"),t.qZA())}function P(i,c){1&i&&(t.TgZ(0,"small"),t._uU(1,"Name on Card is a required field"),t.qZA())}function U(i,c){1&i&&(t.TgZ(0,"small"),t._uU(1,"Card Number is a required field"),t.qZA())}function I(i,c){1&i&&(t.TgZ(0,"small"),t._uU(1,"Expiry Date is a required field"),t.qZA())}function N(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"h3",4),t._uU(2,"Checkout Page"),t.qZA(),t.TgZ(3,"div",5)(4,"div",6)(5,"h3",7),t._uU(6,"Your Items:"),t.qZA(),t.TgZ(7,"ul",8),t.YNc(8,O,8,3,"li",9),t.qZA(),t.TgZ(9,"h4",10),t._uU(10),t.qZA()(),t.TgZ(11,"div",11)(12,"h3",7),t._uU(13,"Payment Details:"),t.qZA(),t.TgZ(14,"form",12,13),t.NdJ("ngSubmit",function(){t.CHM(e);const n=t.MAs(15),s=t.oxw();return t.KtG(s.onSubmit(n))}),t.TgZ(16,"div",14)(17,"label",15),t._uU(18,"Address"),t.qZA(),t.TgZ(19,"input",16,17),t.NdJ("ngModelChange",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s._address=n)}),t.qZA(),t.YNc(21,M,2,0,"small",2),t.qZA(),t.TgZ(22,"div",14)(23,"label",18),t._uU(24,"Name on Card"),t.qZA(),t.TgZ(25,"input",19,20),t.NdJ("ngModelChange",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s._nameOnCard=n)}),t.qZA(),t.YNc(27,P,2,0,"small",2),t.qZA(),t.TgZ(28,"div",14)(29,"label",21),t._uU(30,"Card Number"),t.qZA(),t.TgZ(31,"input",22,23),t.NdJ("ngModelChange",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s._cardNumber=n)}),t.qZA(),t.YNc(33,U,2,0,"small",2),t.qZA(),t.TgZ(34,"div",14)(35,"label",24),t._uU(36,"Expiry Date"),t.qZA(),t.TgZ(37,"input",25,26),t.NdJ("ngModelChange",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s._expiryDate=n)}),t.qZA(),t.YNc(39,I,2,0,"small",2),t.qZA(),t.TgZ(40,"button",27),t._uU(41,"Pay"),t.qZA()()()()()}if(2&i){const e=t.MAs(20),r=t.MAs(26),n=t.MAs(32),s=t.MAs(38),a=t.oxw();t.xp6(8),t.Q6J("ngForOf",a.displayCart),t.xp6(2),t.Oqu("Your Cart Total: $"+a.cartTotal),t.xp6(9),t.Q6J("ngModel",a._address),t.xp6(2),t.Q6J("ngIf",e.invalid&&e.touched),t.xp6(4),t.Q6J("ngModel",a._nameOnCard),t.xp6(2),t.Q6J("ngIf",r.invalid&&r.touched),t.xp6(4),t.Q6J("ngModel",a._cardNumber),t.xp6(2),t.Q6J("ngIf",n.invalid&&n.touched),t.xp6(4),t.Q6J("ngModel",a._expiryDate),t.xp6(2),t.Q6J("ngIf",s.invalid&&s.touched)}}let F=(()=>{class i{constructor(e,r,n,s,a){this.userS=e,this.aservice=r,this.router=n,this.l=s,this.cservice=a,this.displayCart=[],this._address="",this._nameOnCard="",this._cardNumber=0,this._expiryDate=""}ngOnInit(){this.cartSub=this.cservice.cartChanged.subscribe(e=>{localStorage.getItem("cart")||e?localStorage.getItem("cart")&&!e?(this.cart=JSON.parse(localStorage.getItem("cart")),this.displayCart=this.cservice.displayCartGetter(this.cart)):(!localStorage.getItem("cart")&&e||localStorage.getItem("cart")&&e)&&(this.cart=e,this.displayCart=this.cservice.displayCartGetter(this.cart)):(this.cart=[],this.displayCart=[]);let r=0;for(let n=0;n<this.displayCart.length;n++)r+=this.displayCart[n].product.price*this.displayCart[n].quantity;this.cartTotal=r,this._address="200, Fictional Street, Gurugram",this._nameOnCard="Testy Tester",this._cardNumber=0x462d53c8abac0,this._expiryDate="11/27"}),this.userSub=this.aservice.User.subscribe(e=>{this.user=e})}ngOnDestroy(){this.userSub.unsubscribe(),this.cartSub.unsubscribe()}onSubmit(e){this.l.isLoading.next(!0),this.userS.createOrder(this.cart,this.user).subscribe(()=>{this.l.isLoading.next(!1),this.cservice.cartChanged.next(null),this.cservice.cart=[],localStorage.removeItem("cart"),this.router.navigate(["/buying/complete"])})}static#t=this.\u0275fac=function(r){return new(r||i)(t.Y36(_.K),t.Y36(x.e),t.Y36(p.F0),t.Y36(Z.b),t.Y36(h.m))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-buy-product"]],decls:3,vars:2,consts:[[1,"container"],["class","display-3 text-center",4,"ngIf"],[4,"ngIf"],[1,"display-3","text-center"],[1,"display-3","text-center","mb-4"],[1,"row","mb-4"],[1,"col-md-6"],[1,"text-center","mb-4","lead"],[1,"list-group"],["class","list-group-item d-flex justify-content-between",4,"ngFor","ngForOf"],[1,"text-center","my-3"],[1,"col-md-6","card"],[3,"ngSubmit"],["f","ngForm"],[1,"form-group"],["for","address"],["type","text","name","address","id","address","required","",1,"form-control",3,"ngModel","ngModelChange"],["address","ngModel"],["for","nameOnCard"],["type","text","name","nameOnCard","id","nameOnCard","required","",1,"form-control",3,"ngModel","ngModelChange"],["nameOnCard","ngModel"],["for","cardNumber"],["type","number","name","cardNumber","id","cardNumber","required","",1,"form-control",3,"ngModel","ngModelChange"],["cardNumber","ngModel"],["for","expiry"],["type","text","name","expiry","id","expiry","required","",1,"form-control",3,"ngModel","ngModelChange"],["expiryDate","ngModel"],["type","submit",1,"btn","btn-primary","mb-3"],[1,"list-group-item","d-flex","justify-content-between"],[1,"d-flex","justify-content-between"],[1,"ml-2","mr-5"]],template:function(r,n){1&r&&(t.TgZ(0,"div",0),t.YNc(1,A,2,0,"h3",1),t.YNc(2,N,42,10,"div",2),t.qZA()),2&r&&(t.xp6(1),t.Q6J("ngIf",!n.displayCart.length),t.xp6(1),t.Q6J("ngIf",n.displayCart.length))},dependencies:[d.sg,d.O5,l._Y,l.Fj,l.wV,l.JJ,l.JL,l.Q7,l.On,l.F],styles:["small[_ngcontent-%COMP%]{color:red}input.ng-invalid.ng-touched[_ngcontent-%COMP%]{border:solid 1px red}"]})}return i})();function J(i,c){1&i&&(t.TgZ(0,"div",3)(1,"h3",4),t._uU(2,"Your Cart is empty"),t.qZA()())}function Y(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"div",9),t._UZ(1,"img",10),t.TgZ(2,"span"),t._uU(3),t.qZA(),t.TgZ(4,"span"),t._uU(5),t.qZA(),t.TgZ(6,"div")(7,"button",11),t.NdJ("click",function(){const s=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.subtractProduct(s))}),t._uU(8,"-"),t.qZA(),t.TgZ(9,"span"),t._uU(10),t.qZA(),t.TgZ(11,"button",11),t.NdJ("click",function(){const s=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.addProduct(s))}),t._uU(12,"+"),t.qZA()()()}if(2&i){const e=c.$implicit;t.xp6(1),t.Q6J("src",e.product.url,t.LSH),t.xp6(2),t.Oqu(e.product.name),t.xp6(2),t.Oqu("$"+e.product.price),t.xp6(5),t.Oqu(" "+e.quantity+" ")}}const S=function(){return["/buying/checkout"]};function G(i,c){if(1&i&&(t.TgZ(0,"div")(1,"h3",5),t._uU(2,"Your Cart"),t.qZA(),t.YNc(3,Y,13,4,"div",6),t.TgZ(4,"h4",7),t._uU(5),t.qZA(),t.TgZ(6,"button",8),t._uU(7,"Checkout"),t.qZA()()),2&i){const e=t.oxw();t.xp6(3),t.Q6J("ngForOf",e.displayCart),t.xp6(2),t.Oqu("Your Cart Total: $"+e.cartTotal),t.xp6(1),t.Q6J("routerLink",t.DdM(3,S))}}let Q=(()=>{class i{constructor(e){this.cservice=e}ngOnInit(){this.cartSub=this.cservice.cartChanged.subscribe(e=>{localStorage.getItem("cart")||e?localStorage.getItem("cart")&&!e?(this.cart=JSON.parse(localStorage.getItem("cart")),this.displayCart=this.cservice.displayCartGetter(this.cart)):(!localStorage.getItem("cart")&&e||localStorage.getItem("cart")&&e)&&(this.cart=e,this.displayCart=this.cservice.displayCartGetter(this.cart)):(this.cart=[],this.displayCart=[]);let r=0;for(let n=0;n<this.displayCart.length;n++)r+=this.displayCart[n].product.price*this.displayCart[n].quantity;this.cartTotal=r})}addProduct(e){let r=this.displayCart.findIndex(n=>n.product.id===e.product.id);this.displayCart[r].quantity++,this.cart[r].quantity++,this.cservice.editCart(this.cart)}subtractProduct(e){let r=this.displayCart.findIndex(n=>n.product.id===e.product.id);this.displayCart[r].quantity--,this.cart[r].quantity--,0===this.displayCart[r].quantity&&(this.displayCart.splice(r,1),this.cart.splice(r,1)),this.cservice.editCart(this.cart)}ngOnDestroy(){this.cartSub.unsubscribe()}static#t=this.\u0275fac=function(r){return new(r||i)(t.Y36(h.m))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-cart-page"]],decls:3,vars:2,consts:[[1,"container"],["class","w-100 empty d-flex align-items-center justify-content-center",4,"ngIf"],[4,"ngIf"],[1,"w-100","empty","d-flex","align-items-center","justify-content-center"],[1,"display-3"],[1,"display-3","text-center","mb-3"],["class","d-flex justify-content-between align-items-center border mb-4",4,"ngFor","ngForOf"],[1,"display-4","text-center","my-5"],[1,"btn","btn-primary","btn-block","mb-5",3,"routerLink"],[1,"d-flex","justify-content-between","align-items-center","border","mb-4"],[3,"src"],[1,"btn","btn-outline-primary",3,"click"]],template:function(r,n){1&r&&(t.TgZ(0,"div",0),t.YNc(1,J,3,0,"div",1),t.YNc(2,G,8,4,"div",2),t.qZA()),2&r&&(t.xp6(1),t.Q6J("ngIf",!n.displayCart.length),t.xp6(1),t.Q6J("ngIf",n.displayCart.length))},dependencies:[d.sg,d.O5,p.rH],styles:[".card[_ngcontent-%COMP%]{height:100px}img[_ngcontent-%COMP%]{height:100px;width:120px;object-fit:cover}@media (max-width: 410px){img[_ngcontent-%COMP%]{height:80px;width:100px}}.empty[_ngcontent-%COMP%]{height:80vh}"]})}return i})(),w=(()=>{class i{constructor(){}ngOnInit(){}static#t=this.\u0275fac=function(r){return new(r||i)};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-complete"]],decls:3,vars:0,consts:[[1,"container"],[1,"display-3"]],template:function(r,n){1&r&&(t.TgZ(0,"div",0)(1,"h3",1),t._uU(2," Purchase complete "),t.qZA()())},styles:[".container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:80vh}"]})}return i})();function j(i,c){1&i&&(t.TgZ(0,"div",3)(1,"h3",4),t._uU(2,"You have not placed any orders"),t.qZA()())}function B(i,c){if(1&i&&(t.TgZ(0,"li",13)(1,"span"),t._uU(2),t.qZA(),t.TgZ(3,"div",14)(4,"span",15),t._uU(5),t.qZA(),t.TgZ(6,"span"),t._uU(7),t.qZA()()()),2&i){const e=c.$implicit;t.xp6(2),t.Oqu(e.product.name),t.xp6(3),t.Oqu("$"+e.product.price),t.xp6(2),t.Oqu("Quantity :"+e.quantity)}}function L(i,c){if(1&i&&(t.TgZ(0,"div")(1,"h3",8),t._uU(2),t.qZA(),t.TgZ(3,"div",9)(4,"ul",10),t.YNc(5,B,8,3,"li",11),t.qZA(),t.TgZ(6,"div",12),t._uU(7),t.qZA()()()),2&i){const e=c.$implicit,r=c.index,n=t.oxw(2);t.xp6(2),t.Oqu("Order "+(r+1)),t.xp6(3),t.Q6J("ngForOf",e),t.xp6(2),t.hij(" ","Order Total: $"+n.orderTotals[r]," ")}}function $(i,c){if(1&i&&(t.TgZ(0,"div",5)(1,"div",6),t._uU(2),t.qZA(),t.YNc(3,L,8,3,"div",7),t.qZA()),2&i){const e=t.oxw();t.xp6(2),t.hij("Hello, ",e.user.email," here are your previous orders: "),t.xp6(1),t.Q6J("ngForOf",e.displayCarts)}}let D=(()=>{class i{constructor(e){this.aroute=e,this.displayCarts=[],this.orderTotals=[]}ngOnInit(){this.user=this.aroute.snapshot.data.res2.user,this.displayCarts=this.aroute.snapshot.data.res2.res,this.orderTotals=this.aroute.snapshot.data.res2.t}static#t=this.\u0275fac=function(r){return new(r||i)(t.Y36(p.gz))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-order"]],decls:3,vars:2,consts:[[1,"container"],["class","w-100 no-orders d-flex align-items-center justify-content-center",4,"ngIf"],["class","mb-5",4,"ngIf"],[1,"w-100","no-orders","d-flex","align-items-center","justify-content-center"],[1,"display-3","text-center"],[1,"mb-5"],[1,"lead","text-center","mb-3"],[4,"ngFor","ngForOf"],[1,"display-4","text-center"],[1,"card","mb-4"],[1,"list-group"],["class","list-group-item d-flex justify-content-between",4,"ngFor","ngForOf"],[1,"card-footer"],[1,"list-group-item","d-flex","justify-content-between"],[1,"d-flex","justify-content-between"],[1,"ml-2","mr-5"]],template:function(r,n){1&r&&(t.TgZ(0,"div",0),t.YNc(1,j,3,0,"div",1),t.YNc(2,$,4,2,"div",2),t.qZA()),2&r&&(t.xp6(1),t.Q6J("ngIf",!n.displayCarts.length),t.xp6(1),t.Q6J("ngIf",n.displayCarts.length))},dependencies:[d.sg,d.O5],styles:[".no-orders[_ngcontent-%COMP%]{height:80vh}"]})}return i})();var g=o(6631),T=o(2361),H=o(1221),m=o(1086),f=o(8807),z=o(2868),K=o(3754),E=o(529);let X=(()=>{class i{constructor(e){this.http=e,this.api="https://ng-ecommerce-electronics-default-rtdb.firebaseio.com/"}getOrder(e){return this.http.get(`${this.api}/orders/${e}.json`)}static#t=this.\u0275fac=function(r){return new(r||i)(t.LFG(E.eN))};static#e=this.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();const V=[{path:"checkout",component:F,resolve:[T.$],canActivate:[g.a]},{path:"complete",component:w,canActivate:[g.a]},{path:"orders",component:D,resolve:{res2:(()=>{class i{constructor(e,r,n,s,a,u){this.aservice=e,this.uservice=r,this.l=n,this.dservice=s,this.oservice=a,this.cservice=u}resolve(e,r){this.l.isLoading.next(!0);let n=[],s=[];return this.dservice.getProducts().pipe((0,f.z)(()=>this.aservice.User.pipe((0,f.z)(a=>a?this.uservice.loadUserOrders(a).pipe((0,f.z)(u=>{if(u){let b=[];console.log(u);for(let y=0;y<u.length;y++)b.push(this.oservice.getOrder(u[y]).pipe((0,z.b)(v=>{console.log(v),n.push(this.cservice.displayCartGetter(v)),s.push(this.cservice.displayCartGetter(v).reduce((W,q)=>W+q.product.price*q.quantity,0))})));return(0,H.z)(...b).subscribe(),setTimeout(()=>{this.l.isLoading.next(!1)},1e3),(0,m.of)({user:a,res:n,t:s})}return this.l.isLoading.next(!1),(0,m.of)({user:a,res:[],t:[]})})):(this.l.isLoading.next(!1),(0,m.of)({user:null,res:[],t:[]}))))))}static#t=this.\u0275fac=function(r){return new(r||i)(t.LFG(x.e),t.LFG(_.K),t.LFG(Z.b),t.LFG(K.f),t.LFG(X),t.LFG(h.m))};static#e=this.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})()},canActivate:[g.a]},{path:"cart",component:Q,resolve:[T.$],canActivate:[g.a]}];let R=(()=>{class i{static#t=this.\u0275fac=function(r){return new(r||i)};static#e=this.\u0275mod=t.oAB({type:i});static#i=this.\u0275inj=t.cJS({imports:[d.ez,l.u5,p.Bz.forChild(V)]})}return i})()}}]);