"use strict";(self.webpackChunkfirst_app=self.webpackChunkfirst_app||[]).push([[258],{7258:(tt,C,n)=>{n.r(C),n.d(C,{BuyingModule:()=>R});var u=n(6895),t=n(6738),x=n(1215),_=n(914),p=n(2517),Z=n(4471),m=n(6551),l=n(4719);function A(i,a){1&i&&(t.TgZ(0,"h3",3),t._uU(1,"Your Cart is empty"),t.qZA())}function O(i,a){if(1&i&&(t.TgZ(0,"li",28)(1,"span"),t._uU(2),t.qZA(),t.TgZ(3,"div",29)(4,"span",30),t._uU(5),t.qZA(),t.TgZ(6,"span"),t._uU(7),t.qZA()()()),2&i){const e=a.$implicit;t.xp6(2),t.Oqu(e.product.name),t.xp6(3),t.Oqu("$"+e.product.price),t.xp6(2),t.Oqu("Quantity :"+e.quantity)}}function U(i,a){1&i&&(t.TgZ(0,"small"),t._uU(1,"Address is a required field"),t.qZA())}function I(i,a){1&i&&(t.TgZ(0,"small"),t._uU(1,"Name on Card is a required field"),t.qZA())}function P(i,a){1&i&&(t.TgZ(0,"small"),t._uU(1,"Card Number is a required field"),t.qZA())}function F(i,a){1&i&&(t.TgZ(0,"small"),t._uU(1,"Expiry Date is a required field"),t.qZA())}function Y(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"h3",4),t._uU(2,"Checkout Page"),t.qZA(),t.TgZ(3,"div",5)(4,"div",6)(5,"h3",7),t._uU(6,"Your Items:"),t.qZA(),t.TgZ(7,"ul",8),t.YNc(8,O,8,3,"li",9),t.qZA(),t.TgZ(9,"h4",10),t._uU(10),t.qZA()(),t.TgZ(11,"div",11)(12,"h3",7),t._uU(13,"Payment Details:"),t.qZA(),t.TgZ(14,"form",12,13),t.NdJ("ngSubmit",function(){t.CHM(e);const s=t.MAs(15),o=t.oxw();return t.KtG(o.onSubmit(s))}),t.TgZ(16,"div",14)(17,"label",15),t._uU(18,"Address"),t.qZA(),t._UZ(19,"input",16,17),t.YNc(21,U,2,0,"small",2),t.qZA(),t.TgZ(22,"div",14)(23,"label",18),t._uU(24,"Name on Card"),t.qZA(),t._UZ(25,"input",19,20),t.YNc(27,I,2,0,"small",2),t.qZA(),t.TgZ(28,"div",14)(29,"label",21),t._uU(30,"Card Number"),t.qZA(),t._UZ(31,"input",22,23),t.YNc(33,P,2,0,"small",2),t.qZA(),t.TgZ(34,"div",14)(35,"label",24),t._uU(36,"Expiry Date"),t.qZA(),t._UZ(37,"input",25,26),t.YNc(39,F,2,0,"small",2),t.qZA(),t.TgZ(40,"button",27),t._uU(41,"Pay"),t.qZA()()()()()}if(2&i){const e=t.MAs(15),r=t.MAs(20),s=t.MAs(26),o=t.MAs(32),c=t.MAs(38),d=t.oxw();t.xp6(8),t.Q6J("ngForOf",d.displayCart),t.xp6(2),t.Oqu("Your Cart Total: $"+d.cartTotal),t.xp6(11),t.Q6J("ngIf",r.invalid&&r.touched),t.xp6(6),t.Q6J("ngIf",s.invalid&&s.touched),t.xp6(6),t.Q6J("ngIf",o.invalid&&o.touched),t.xp6(6),t.Q6J("ngIf",c.invalid&&c.touched),t.xp6(1),t.Q6J("disabled",e.invalid)}}let M=(()=>{class i{constructor(e,r,s,o,c){this.userS=e,this.aservice=r,this.router=s,this.l=o,this.cservice=c,this.displayCart=[]}ngOnInit(){this.cartSub=this.cservice.cartChanged.subscribe(e=>{localStorage.getItem("cart")||e?localStorage.getItem("cart")&&!e?(this.cart=JSON.parse(localStorage.getItem("cart")),this.displayCart=this.cservice.displayCartGetter(this.cart)):(!localStorage.getItem("cart")&&e||localStorage.getItem("cart")&&e)&&(this.cart=e,this.displayCart=this.cservice.displayCartGetter(this.cart)):(this.cart=[],this.displayCart=[]);let r=0;for(let s=0;s<this.displayCart.length;s++)r+=this.displayCart[s].product.price*this.displayCart[s].quantity;this.cartTotal=r}),this.userSub=this.aservice.User.subscribe(e=>{this.user=e})}ngOnDestroy(){this.userSub.unsubscribe(),this.cartSub.unsubscribe()}onSubmit(e){this.l.isLoading.next(!0),this.userS.createOrder(this.cart,this.user).subscribe(()=>{this.l.isLoading.next(!1),this.cservice.cartChanged.next(null),this.cservice.cart=[],localStorage.removeItem("cart"),this.router.navigate(["/buying/complete"])})}static#t=this.\u0275fac=function(r){return new(r||i)(t.Y36(x.K),t.Y36(_.e),t.Y36(p.F0),t.Y36(Z.b),t.Y36(m.m))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-buy-product"]],decls:3,vars:2,consts:[[1,"container"],["class","display-3 text-center",4,"ngIf"],[4,"ngIf"],[1,"display-3","text-center"],[1,"display-3","text-center","mb-4"],[1,"row","mb-4"],[1,"col-md-6"],[1,"text-center","mb-4","lead"],[1,"list-group"],["class","list-group-item d-flex justify-content-between",4,"ngFor","ngForOf"],[1,"text-center","my-3"],[1,"col-md-6","card"],[3,"ngSubmit"],["f","ngForm"],[1,"form-group"],["for","address"],["type","text","ngModel","","name","address","id","address","required","",1,"form-control"],["address","ngModel"],["for","nameOnCard"],["type","text","ngModel","","name","nameOnCard","id","nameOnCard","required","",1,"form-control"],["nameOnCard","ngModel"],["for","cardNumber"],["type","number","ngModel","","name","cardNumber","id","cardNumber","required","",1,"form-control"],["cardNumber","ngModel"],["for","expiry"],["type","text","ngModel","","name","expiry","id","expiry","required","",1,"form-control"],["expiryDate","ngModel"],["type","submit",1,"btn","btn-primary","mb-3",3,"disabled"],[1,"list-group-item","d-flex","justify-content-between"],[1,"d-flex","justify-content-between"],[1,"ml-2","mr-5"]],template:function(r,s){1&r&&(t.TgZ(0,"div",0),t.YNc(1,A,2,0,"h3",1),t.YNc(2,Y,42,7,"div",2),t.qZA()),2&r&&(t.xp6(1),t.Q6J("ngIf",!s.displayCart.length),t.xp6(1),t.Q6J("ngIf",s.displayCart.length))},dependencies:[u.sg,u.O5,l._Y,l.Fj,l.wV,l.JJ,l.JL,l.Q7,l.On,l.F],styles:["small[_ngcontent-%COMP%]{color:red}input.ng-invalid.ng-touched[_ngcontent-%COMP%]{border:solid 1px red}"]})}return i})();function N(i,a){1&i&&(t.TgZ(0,"div",3)(1,"h3",4),t._uU(2,"Your Cart is empty"),t.qZA()())}function S(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",9),t._UZ(1,"img",10),t.TgZ(2,"span"),t._uU(3),t.qZA(),t.TgZ(4,"span"),t._uU(5),t.qZA(),t.TgZ(6,"div")(7,"button",11),t.NdJ("click",function(){const o=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.subtractProduct(o))}),t._uU(8,"-"),t.qZA(),t.TgZ(9,"span"),t._uU(10),t.qZA(),t.TgZ(11,"button",11),t.NdJ("click",function(){const o=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.addProduct(o))}),t._uU(12,"+"),t.qZA()()()}if(2&i){const e=a.$implicit;t.xp6(1),t.Q6J("src",e.product.url,t.LSH),t.xp6(2),t.Oqu(e.product.name),t.xp6(2),t.Oqu("$"+e.product.price),t.xp6(5),t.Oqu(" "+e.quantity+" ")}}const J=function(){return["/buying/checkout"]};function Q(i,a){if(1&i&&(t.TgZ(0,"div")(1,"h3",5),t._uU(2,"Your Cart"),t.qZA(),t.YNc(3,S,13,4,"div",6),t.TgZ(4,"h4",7),t._uU(5),t.qZA(),t.TgZ(6,"button",8),t._uU(7,"Checkout"),t.qZA()()),2&i){const e=t.oxw();t.xp6(3),t.Q6J("ngForOf",e.displayCart),t.xp6(2),t.Oqu("Your Cart Total: $"+e.cartTotal),t.xp6(1),t.Q6J("routerLink",t.DdM(3,J))}}let j=(()=>{class i{constructor(e){this.cservice=e}ngOnInit(){this.cartSub=this.cservice.cartChanged.subscribe(e=>{localStorage.getItem("cart")||e?localStorage.getItem("cart")&&!e?(this.cart=JSON.parse(localStorage.getItem("cart")),this.displayCart=this.cservice.displayCartGetter(this.cart)):(!localStorage.getItem("cart")&&e||localStorage.getItem("cart")&&e)&&(this.cart=e,this.displayCart=this.cservice.displayCartGetter(this.cart)):(this.cart=[],this.displayCart=[]);let r=0;for(let s=0;s<this.displayCart.length;s++)r+=this.displayCart[s].product.price*this.displayCart[s].quantity;this.cartTotal=r})}addProduct(e){let r=this.displayCart.findIndex(s=>s.product.id===e.product.id);this.displayCart[r].quantity++,this.cart[r].quantity++,this.cservice.editCart(this.cart)}subtractProduct(e){let r=this.displayCart.findIndex(s=>s.product.id===e.product.id);this.displayCart[r].quantity--,this.cart[r].quantity--,0===this.displayCart[r].quantity&&(this.displayCart.splice(r,1),this.cart.splice(r,1)),this.cservice.editCart(this.cart)}ngOnDestroy(){this.cartSub.unsubscribe()}static#t=this.\u0275fac=function(r){return new(r||i)(t.Y36(m.m))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-cart-page"]],decls:3,vars:2,consts:[[1,"container"],["class","w-100 empty d-flex align-items-center justify-content-center",4,"ngIf"],[4,"ngIf"],[1,"w-100","empty","d-flex","align-items-center","justify-content-center"],[1,"display-3"],[1,"display-3","text-center","mb-3"],["class","d-flex justify-content-between align-items-center border mb-4",4,"ngFor","ngForOf"],[1,"display-4","text-center","my-5"],[1,"btn","btn-primary","btn-block","mb-5",3,"routerLink"],[1,"d-flex","justify-content-between","align-items-center","border","mb-4"],[3,"src"],[1,"btn","btn-primary",3,"click"]],template:function(r,s){1&r&&(t.TgZ(0,"div",0),t.YNc(1,N,3,0,"div",1),t.YNc(2,Q,8,4,"div",2),t.qZA()),2&r&&(t.xp6(1),t.Q6J("ngIf",!s.displayCart.length),t.xp6(1),t.Q6J("ngIf",s.displayCart.length))},dependencies:[u.sg,u.O5,p.rH],styles:[".card[_ngcontent-%COMP%]{height:100px}img[_ngcontent-%COMP%]{height:100px;width:120px;object-fit:cover}.empty[_ngcontent-%COMP%]{height:80vh}"]})}return i})(),G=(()=>{class i{constructor(){}ngOnInit(){}static#t=this.\u0275fac=function(r){return new(r||i)};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-complete"]],decls:3,vars:0,consts:[[1,"container"],[1,"display-3"]],template:function(r,s){1&r&&(t.TgZ(0,"div",0)(1,"h3",1),t._uU(2," Purchase complete "),t.qZA()())},styles:[".container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:80vh}"]})}return i})();function L(i,a){1&i&&(t.TgZ(0,"div",3)(1,"h3",4),t._uU(2,"You have not placed any orders"),t.qZA()())}function $(i,a){if(1&i&&(t.TgZ(0,"li",13)(1,"span"),t._uU(2),t.qZA(),t.TgZ(3,"div",14)(4,"span",15),t._uU(5),t.qZA(),t.TgZ(6,"span"),t._uU(7),t.qZA()()()),2&i){const e=a.$implicit;t.xp6(2),t.Oqu(e.product.name),t.xp6(3),t.Oqu("$"+e.product.price),t.xp6(2),t.Oqu("Quantity :"+e.quantity)}}function w(i,a){if(1&i&&(t.TgZ(0,"div")(1,"h3",8),t._uU(2),t.qZA(),t.TgZ(3,"div",9)(4,"ul",10),t.YNc(5,$,8,3,"li",11),t.qZA(),t.TgZ(6,"div",12),t._uU(7),t.qZA()()()),2&i){const e=a.$implicit,r=a.index,s=t.oxw(2);t.xp6(2),t.Oqu("Order "+(r+1)),t.xp6(3),t.Q6J("ngForOf",e),t.xp6(2),t.hij(" ","Order Total: $"+s.orderTotals[r]," ")}}function B(i,a){if(1&i&&(t.TgZ(0,"div",5)(1,"div",6),t._uU(2),t.qZA(),t.YNc(3,w,8,3,"div",7),t.qZA()),2&i){const e=t.oxw();t.xp6(2),t.hij("Hello, ",e.user.email," here are your previous orders: "),t.xp6(1),t.Q6J("ngForOf",e.displayCarts)}}let z=(()=>{class i{constructor(e){this.aroute=e,this.displayCarts=[],this.orderTotals=[]}ngOnInit(){this.user=this.aroute.snapshot.data.res2.user,this.displayCarts=this.aroute.snapshot.data.res2.res,this.orderTotals=this.aroute.snapshot.data.res2.t}static#t=this.\u0275fac=function(r){return new(r||i)(t.Y36(p.gz))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-order"]],decls:3,vars:2,consts:[[1,"container"],["class","w-100 no-orders d-flex align-items-center justify-content-center",4,"ngIf"],["class","mb-5",4,"ngIf"],[1,"w-100","no-orders","d-flex","align-items-center","justify-content-center"],[1,"display-3","text-center"],[1,"mb-5"],[1,"lead","text-center","mb-3"],[4,"ngFor","ngForOf"],[1,"display-4","text-center"],[1,"card","mb-4"],[1,"list-group"],["class","list-group-item d-flex justify-content-between",4,"ngFor","ngForOf"],[1,"card-footer"],[1,"list-group-item","d-flex","justify-content-between"],[1,"d-flex","justify-content-between"],[1,"ml-2","mr-5"]],template:function(r,s){1&r&&(t.TgZ(0,"div",0),t.YNc(1,L,3,0,"div",1),t.YNc(2,B,4,2,"div",2),t.qZA()),2&r&&(t.xp6(1),t.Q6J("ngIf",!s.displayCarts.length),t.xp6(1),t.Q6J("ngIf",s.displayCarts.length))},dependencies:[u.sg,u.O5],styles:[".no-orders[_ngcontent-%COMP%]{height:80vh}"]})}return i})();var h=n(6631),b=n(2361),D=n(1221),g=n(1086),f=n(8807),H=n(2868),K=n(3754),E=n(529);let X=(()=>{class i{constructor(e){this.http=e,this.api="https://ng-ecommerce-electronics-default-rtdb.firebaseio.com/"}getOrder(e){return this.http.get(`${this.api}/orders/${e}.json`)}static#t=this.\u0275fac=function(r){return new(r||i)(t.LFG(E.eN))};static#e=this.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();const V=[{path:"checkout",component:M,resolve:[b.$],canActivate:[h.a]},{path:"complete",component:G,canActivate:[h.a]},{path:"orders",component:z,resolve:{res2:(()=>{class i{constructor(e,r,s,o,c,d){this.aservice=e,this.uservice=r,this.l=s,this.dservice=o,this.oservice=c,this.cservice=d}resolve(e,r){this.l.isLoading.next(!0);let s=[],o=[];return this.dservice.getProducts().pipe((0,f.z)(()=>this.aservice.User.pipe((0,f.z)(c=>c?this.uservice.loadUserOrders(c).pipe((0,f.z)(d=>{if(d){let T=[];console.log(d);for(let y=0;y<d.length;y++)T.push(this.oservice.getOrder(d[y]).pipe((0,H.b)(v=>{console.log(v),s.push(this.cservice.displayCartGetter(v)),o.push(this.cservice.displayCartGetter(v).reduce((W,q)=>W+q.product.price*q.quantity,0))})));return(0,D.z)(...T).subscribe(),setTimeout(()=>{this.l.isLoading.next(!1)},1e3),(0,g.of)({user:c,res:s,t:o})}return this.l.isLoading.next(!1),(0,g.of)({user:c,res:[],t:[]})})):(this.l.isLoading.next(!1),(0,g.of)({user:null,res:[],t:[]}))))))}static#t=this.\u0275fac=function(r){return new(r||i)(t.LFG(_.e),t.LFG(x.K),t.LFG(Z.b),t.LFG(K.f),t.LFG(X),t.LFG(m.m))};static#e=this.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})()},canActivate:[h.a]},{path:"cart",component:j,resolve:[b.$],canActivate:[h.a]}];let R=(()=>{class i{static#t=this.\u0275fac=function(r){return new(r||i)};static#e=this.\u0275mod=t.oAB({type:i});static#i=this.\u0275inj=t.cJS({imports:[u.ez,l.u5,p.Bz.forChild(V)]})}return i})()}}]);